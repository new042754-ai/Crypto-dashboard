<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>JK ALGO â€” Market (Live)</title>
  <style>
    :root {
      --green:#22c55e; --red:#ef4444; --muted:#666; --ink:#111; --line:#eaeaea; --accent:#111827;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#fff;color:var(--ink);padding-bottom:84px}

    /* Top */
    .header{padding:16px 16px 8px;font-size:24px;font-weight:800}
    .tabs{display:flex;gap:18px;overflow-x:auto;padding:8px 16px;border-bottom:1px solid var(--line)}
    .tab{white-space:nowrap;font-size:14px;color:var(--muted);padding:6px 0}
    .tab.active{color:#f59e0b;border-bottom:2px solid #f59e0b;font-weight:700}

    /* List */
    .list{padding:6px 10px}
    .row{display:flex;align-items:center;justify-content:space-between;padding:12px 6px;border-bottom:1px solid var(--line)}
    .left{display:flex;align-items:center;gap:10px}
    .logo{width:32px;height:32px;border-radius:50%;object-fit:cover}
    .names{line-height:1.15}
    .pair{font-weight:700}
    .pct{font-size:12px;color:var(--muted)}
    .right{display:flex;gap:8px;align-items:center}
    .pill{min-width:96px;text-align:center;padding:6px 10px;border-radius:6px;color:#fff;font-weight:700}
    .sell{background:var(--red)}
    .buy{background:var(--green)}
    .chip{font-size:11px;background:#fff;border:1px solid var(--line);color:#888;border-radius:10px;padding:2px 6px;margin-left:2px}

    /* Bottom nav */
    .nav{position:fixed;left:0;right:0;bottom:0;height:72px;background:#fff;border-top:1px solid var(--line);display:flex;justify-content:space-around;align-items:center}
    .nav a{display:flex;flex-direction:column;align-items:center;gap:2px;text-decoration:none;color:#555;font-size:13px}
    .nav a.active{color:#000;font-weight:700}
    .mi{font-family:'Material Icons';font-weight:normal;font-style:normal;font-size:26px;line-height:1;display:inline-block}
  </style>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
  <div class="header">Market</div>
  <div class="tabs">
    <div class="tab active">Hot</div>
    <div class="tab">Favourite</div>
    <div class="tab">Forex</div>
    <div class="tab">Crypto</div>
    <div class="tab">Metals</div>
    <div class="tab">Indices</div>
  </div>

  <div id="list" class="list"></div>

  <!-- Bottom Navigation -->
  <nav class="nav">
    <a href="#"><span class="mi">home</span><span>Home</span></a>
    <a href="#" class="active"><span class="mi">candlestick_chart</span><span>Market</span></a>
    <a href="#"><span class="mi">description</span><span>Trade</span></a>
    <a href="#"><span class="mi">explore</span><span>Discover</span></a>
    <a href="#"><span class="mi">person</span><span>My Account</span></a>
  </nav>

  <script>
    // ---------- Config: coins to show ----------
    const COINS = [
      {sym: 'BTCUSDT', name: 'BTC/USDT', logo: 'https://cryptologos.cc/logos/bitcoin-btc-logo.png'},
      {sym: 'ETHUSDT', name: 'ETH/USDT', logo: 'https://cryptologos.cc/logos/ethereum-eth-logo.png'},
      {sym: 'SOLUSDT', name: 'SOL/USDT', logo: 'https://cryptologos.cc/logos/solana-sol-logo.png'},
      {sym: 'XRPUSDT', name: 'XRP/USDT', logo: 'https://cryptologos.cc/logos/xrp-xrp-logo.png'},
      {sym: 'DOGEUSDT', name: 'DOGE/USDT', logo: 'https://cryptologos.cc/logos/dogecoin-doge-logo.png'},
      {sym: 'TRXUSDT', name: 'TRX/USDT', logo: 'https://cryptologos.cc/logos/tron-trx-logo.png'},
      {sym: 'ADAUSDT', name: 'ADA/USDT', logo: 'https://cryptologos.cc/logos/cardano-ada-logo.png'},
      {sym: 'ETCUSDT', name: 'ETC/USDT', logo: 'https://cryptologos.cc/logos/ethereum-classic-etc-logo.png'}
    ];

    // ---------- Helpers (CORS-safe fetch with fallback) ----------
    async function fetchJson(urls) {
      for (const u of urls) {
        try {
          const r = await fetch(u, {cache: 'no-store'});
          if (!r.ok) continue;
          const j = await r.json();
          return j;
        } catch(e) {}
      }
      return null;
    }

    async function getBookTicker(symbol) {
      return fetchJson([
        `https://data.binance.com/api/v3/ticker/bookTicker?symbol=${symbol}`,
        `https://api.binance.com/api/v3/ticker/bookTicker?symbol=${symbol}`
      ]);
    }
    async function get24h(symbol) {
      return fetchJson([
        `https://data.binance.com/api/v3/ticker/24hr?symbol=${symbol}`,
        `https://api.binance.com/api/v3/ticker/24hr?symbol=${symbol}`
      ]);
    }

    // ---------- Render skeleton ----------
    const listEl = document.getElementById('list');
    function renderSkeleton() {
      listEl.innerHTML = COINS.map((c, i) => `
        <div class="row" id="row-${i}">
          <div class="left">
            <img class="logo" src="${c.logo}" alt="${c.name}">
            <div class="names">
              <div class="pair">${c.name}</div>
              <div class="pct" id="pct-${i}">--</div>
            </div>
          </div>
          <div class="right">
            <div class="pill sell" id="sell-${i}">--</div>
            <div class="pill buy" id="buy-${i}">--</div>
          </div>
        </div>
      `).join('');
    }
    renderSkeleton();

    // ---------- Live updater ----------
    async function updateOnce() {
      await Promise.all(COINS.map(async (c, i) => {
        const [book, d24] = await Promise.all([getBookTicker(c.sym), get24h(c.sym)]);
        // Bid/Ask
        const bid = book?.bidPrice ? +book.bidPrice : null;
        const ask = book?.askPrice ? +book.askPrice : null;
        document.getElementById(`sell-${i}`).textContent = bid ? (bid.toLocaleString()) : '--';
        document.getElementById(`buy-${i}`).textContent  = ask ? (ask.toLocaleString()) : '--';

        // 24h % change
        const pct = d24?.priceChangePercent ? Number(d24.priceChangePercent) : null;
        const pctEl = document.getElementById(`pct-${i}`);
        if (pct === null) {
          pctEl.textContent = '--';
          pctEl.style.color = '#666';
        } else {
          pctEl.textContent = (pct >= 0 ? '+' : '') + pct.toFixed(2) + '%';
          pctEl.style.color = pct >= 0 ? 'var(--green)' : 'var(--red)';
        }
      }));
    }

    updateOnce();
    setInterval(updateOnce, 5000);
  </script>
</body>
</html>
